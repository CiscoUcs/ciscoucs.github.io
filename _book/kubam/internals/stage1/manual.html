
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Stage1 - Manual Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../stage2/python.html" />
    
    
    <link rel="prev" href="esxi.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">UCS Developer Resources</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../../API.html">
            
                <a href="../../../API.html">
            
                    
                    UCS API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../../PROGRAMMING.html">
            
                <a href="../../../PROGRAMMING.html">
            
                    
                    Programming Languages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../../CFGMGMT.html">
            
                <a href="../../../CFGMGMT.html">
            
                    
                    Configuration Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../../OS/">
            
                <a href="../../../OS/">
            
                    
                    Operating Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../../../OS/COREOS.html">
            
                <a href="../../../OS/COREOS.html">
            
                    
                    CoreOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../../../OS/REDHAT.html">
            
                <a href="../../../OS/REDHAT.html">
            
                    
                    RedHat
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../../../CONTAINERS/">
            
                <a href="../../../CONTAINERS/">
            
                    
                    Containers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../../../SUPPORT.html">
            
                <a href="../../../SUPPORT.html">
            
                    
                    Support
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">KUBAM</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../">
            
                <a href="../../">
            
                    
                    KUBAM Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../installation/">
            
                <a href="../../installation/">
            
                    
                    Installation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../../installation/standard.html">
            
                <a href="../../installation/standard.html">
            
                    
                    Standard CentOS/RedHat Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../../installation/ubuntu.html">
            
                <a href="../../installation/ubuntu.html">
            
                    
                    Standard Ubuntu Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="../../installation/source.html">
            
                <a href="../../installation/source.html">
            
                    
                    VM based Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="../../installation/security.html">
            
                <a href="../../installation/security.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.5" data-path="../../installation/network.html">
            
                <a href="../../installation/network.html">
            
                    
                    Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.6" data-path="../../installation/other.html">
            
                <a href="../../installation/other.html">
            
                    
                    Other Tricky Installation Tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../configure/">
            
                <a href="../../configure/">
            
                    
                    Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../../configure/creds.md">
            
                <span>
            
                    
                    Credentials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../../configure/network.md">
            
                <span>
            
                    
                    Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../../configure/servers.md">
            
                <span>
            
                    
                    Servers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.4" data-path="../../configure/iso.md">
            
                <span>
            
                    
                    Boot Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.5" data-path="../../configure/settings.html">
            
                <a href="../../configure/settings.html">
            
                    
                    Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.6" data-path="../../configure/template.html">
            
                <a href="../../configure/template.html">
            
                    
                    Kickstart Templates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.7" data-path="../../configure/windows.html">
            
                <a href="../../configure/windows.html">
            
                    
                    Windows vMedia Method (WIP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.8" data-path="../../configure/windows2.html">
            
                <a href="../../configure/windows2.html">
            
                    
                    Windows vMedia/Network Method (WIP)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../">
            
                <a href="../">
            
                    
                    KUBAM Glorious Underbelly
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="docker.html">
            
                <a href="docker.html">
            
                    
                    Stage1 - Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="esxi.html">
            
                <a href="esxi.html">
            
                    
                    Stage1 - ESXi
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.4.3" data-path="manual.html">
            
                <a href="manual.html">
            
                    
                    Stage1 - Manual
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.4" data-path="../stage2/python.html">
            
                <a href="../stage2/python.html">
            
                    
                    Stage2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.5" data-path="../stage3/ansible.html">
            
                <a href="../stage3/ansible.html">
            
                    
                    Stage3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.6" data-path="../stage4/manual.html">
            
                <a href="../stage4/manual.html">
            
                    
                    Stage4
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../../developer/">
            
                <a href="../../developer/">
            
                    
                    KUBAM Developer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="../../developer/API.html">
            
                <a href="../../developer/API.html">
            
                    
                    KUBAM API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="../../developer/APIGUIDE.html">
            
                <a href="../../developer/APIGUIDE.html">
            
                    
                    KUBAM API Walkthrough
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3" data-path="../../developer/YAML.html">
            
                <a href="../../developer/YAML.html">
            
                    
                    KUBAM YAML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Stage1 - Manual</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>For the UCS Bare Metal setup KUBaM uses vMedia Policies to do the automated installation.  This requires the following prereqs: </p>
<ul>
<li>UCS Manager 2.2(2c) or higher.  (Preferably higher... come on!  Update your UCS!)</li>
<li>B200 M3 or C2XX M3 servers or higher.  Servers below these models don&apos;t allow vMedia policies. </li>
<li>One Master Server that has access to UCSM and the Kubernetes Network.  It works easiest if the Master Server is on the same subnet of the kubernetes nodes, but this is not a requirement as long as </li>
</ul>
<h1 id="0-make-sure-package-management-tool-is-working">0. Make sure package management tool is working</h1>
<h2 id="redhatcentos">RedHat/CentOS</h2>
<p>Make sure you have <code>yum</code> set up to get packages. </p>
<h3 id="red-hat">Red Hat</h3>
<p>Example:  If you are behind a firewall: </p>
<pre><code>https_proxy=proxy.esl.cisco.com:80 subscription-manager register
</code></pre><p>You will need to add proxy setup to <code>/etc/yum.conf</code>.  Add a line that looks like the following to the <code>[main]</code> section: </p>
<pre><code>proxy=http://proxy.esl.cisco.com:80
</code></pre><p>The easiest way to get NGINX on redhat is to add the nginx repo:</p>
<pre><code>rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
</code></pre><p>You should now be able to move to the next step!</p>
<h1 id="1-setup-web-server">1. Setup Web Server</h1>
<p>The only service we need running for automated installation is a web server that we can put remote media.  We don&apos;t require TFTP, DHCP, or other PXE services to be in place.  See this <a href="https://communities.cisco.com/people/vbeninco/blog/2017/04/25/pxe-less-automated-installation-of-centosredhat-on-ucs" target="_blank">post</a> for more explanation.</p>
<h2 id="11-nginx-on-centosredhat-7">1.1 nginx on CentOS/RedHat 7</h2>
<pre><code class="lang-bash">yum -y install nginx
systemctl start nginx
systemctl <span class="hljs-built_in">enable</span> nginx <span class="hljs-comment"># so it starts on reboots</span>
</code></pre>
<p>Open the firewall if <code>firewalld</code> is running:</p>
<pre><code>firewall-cmd --zone=public --add-port=80/tcp --permanent
firewall-cmd --reload
</code></pre><p><strong>Note:</strong> this assumes that <code>firewall-cmd --get-active-zones</code> showed the <code>public</code> zone was running. </p>
<p>The root of the webpages defaults to serve from <code>/user/share/nginx/html</code>.  We will put all the ISO files in this directory. </p>
<h3 id="111-allow-directory-listing">1.1.1 Allow directory listing</h3>
<p>By default, nginx doesn&apos;t allow the user to see the files in the root directory.  If you get rid of the <code>index.html</code> file you will then see a <strong>403 Forbidden</strong> error when you try to access the webpage. </p>
<p>We desire to change this behavior so we can see the contents of the installation trees we will create.  </p>
<p>To make this happen modify either <code>/etc/nginx/nginx.conf</code> (CentOS) or the <code>/etc/nginx/conf.d/default.conf</code> (RedHat) file.  After the lines: </p>
<pre><code>location / {
   // maybe some stuff here... maybe not. 
}
</code></pre><p>Adding the following </p>
<h4 id="centos-etcnginxnginxconf">CentOS <code>/etc/nginx/nginx.conf</code></h4>
<pre><code>location /kubam {
  autoindex on;
}
</code></pre><h4 id="redhat-etcnginxconfddefaultconf">RedHat <code>/etc/nginx/conf.d/default.conf</code></h4>
<pre><code>location /kubam {
  root   /usr/share/nginx/html;
  autoindex on;
}
</code></pre><p>Then run: </p>
<pre><code>mkdir /usr/share/nginx/html/kubam
systemctl restart nginx
</code></pre><p>Make sure you can now navigate to the server and see that you can access the directory: </p>
<p><img src="../img/dir.png" alt="directory listing"></p>
<p>We can now put all of our files in the <code>/usr/share/nginx/html/kubam</code> directory and see a listing of all of them when we navigate to <code>http://example.com/kubam/</code>. </p>
<h1 id="2-download-installation-media">2. Download Installation Media</h1>
<h2 id="21-centos-7">2.1 CentOS 7</h2>
<pre><code>cd /usr/share/nginx/html/kubam
</code></pre><p>Do a <code>wget</code> on one of the <a href="http://isoredirect.centos.org/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1611.iso" target="_blank">mirrors that you can find here.</a></p>
<h2 id="22-redhat-7">2.2 RedHat 7</h2>
<p>You&apos;ll need to get it from your subscription or wherever you get RedHat. </p>
<h1 id="3-prepare-boot-iso-media">3. Prepare Boot ISO Media</h1>
<p>For more information on this process <a href="https://ciscoucs.github.io/os/2017/04/20/centos-redhat-baremetal" target="_blank">see this post</a> </p>
<p>The working directory is the html directory of your webserver.  Assume for this example it is <code>/usr/share/nginx/html/kubam/</code></p>
<pre><code>export WORKDIR=/usr/share/nginx/html/kubam
cd $WORKDIR
</code></pre><p>The ISO image for the OS we will install should be in this directory. </p>
<pre><code>mkdir -p mnt stage1
mount -o loop &lt;YOUR ISO IMAGE&gt;.iso mnt
cp -a mnt/isolinux/ stage1/
cp mnt/.discinfo stage1/isolinux
cp -a mnt/LiveOS stage1/isolinux/
cp -a mnt/images/ stage1/isolinux/
umount mnt
</code></pre><p>Edit the <code>stage1/isolinux/isolinux.cfg</code> file: </p>
<h3 id="redhat">RedHat</h3>
<pre><code class="lang-diff">label linux
  menu label ^Install Red Hat Enterprise Linux 7.3
<span class="hljs-addition">+ kernel vmlinuz</span>
  menu default
<span class="hljs-addition">+ append initrd=initrd.img inst.stage2=hd:LABEL=RHEL-7.3\x20Server.x86_64 inst.ks=hd:LABEL=KUBAM:ks.cfg quiet</span>
<span class="hljs-deletion">- append initrd=initrd.img inst.stage2=hd:LABEL=RHEL-7.3\x20Server.x86_64 quiet</span>

label check
  menu label Test this ^media &amp; install Red Hat Enterprise Linux 7.3
  kernel vmlinuz
<span class="hljs-deletion">- menu default</span>
  append initrd=initrd.img inst.stage2=hd:LABEL=RHEL-7.3\x20Server.x86_64 rd.live.check quiet
</code></pre>
<h3 id="centos">CentOS</h3>
<pre><code class="lang-diff">label linux
  menu label ^Install CentOS Linux 7
<span class="hljs-addition">+ kernel vmlinuz</span>
  menu default
<span class="hljs-addition">+ append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet</span>
<span class="hljs-deletion">- append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20xx86_64 inst.ks=hd:LABEL=KUBAM:ks.cfg quiet</span>

label check
  menu label Test this ^media &amp; install CentOS Linux 7
  kernel vmlinuz
<span class="hljs-deletion">- menu default</span>
  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet
</code></pre>
<p>Now Pack up the ISO boot image: </p>
<pre><code>yum -y install mkisofs
</code></pre><h3 id="centos">CentOS</h3>
<pre><code>mkisofs -o $WORKDIR/centos73-boot.iso -b isolinux.bin \
    -c boot.cat -no-emul-boot -V &apos;CentOS 7 x86_64&apos; \
    -boot-load-size 4 -boot-info-table -r -J -v -T stage1/isolinux
</code></pre><h3 id="redhat">RedHat</h3>
<pre><code>mkisofs -o $WORKDIR/rh73-boot.iso -b isolinux.bin \
    -c boot.cat -no-emul-boot -V &apos;RHEL-7.3 Server.x86_64&apos; \
    -boot-load-size 4 -boot-info-table -r -J -v -T stage1/isolinux
</code></pre><p>Tragically, this is a 497MB image.  &#x1F630;</p>
<h1 id="4-prepare-install-tree">4. Prepare Install Tree</h1>
<p>Create a directory with the OS name and copy the contents of the OS ISO to this directory: </p>
<h3 id="centos">CentOS</h3>
<pre><code>mkdir centos7.3
mount -o loop CentOS-7-x86_64-Minimal-1611.iso mnt
cp -a mnt/* centos7.3/
cp mnt/.discinfo centos7.3/
cp mnt/.treeinfo centos7.3/
umount  mnt
</code></pre><h3 id="redhat">RedHat</h3>
<pre><code>mkdir rh7.3
mount -o loop rhel-server-7.3-x86_64-dvd.iso mnt
cp -a mnt/* rh7.3/
cp mnt/.discinfo rh7.3/
cp mnt/.treeinfo rh7.3/
umount mnt
</code></pre><h1 id="5-prepare-kickstart-images">5. Prepare Kickstart Images</h1>
<p>Kickstart Images are used for individual nodes.  Each image should be named after the service profile (SP) name of the server.  If there are spaces in the SP name then they should be given dashes instead of spaces for the name. </p>
<pre><code class="lang-bash"><span class="hljs-built_in">export</span> WORKDIR=/usr/share/nginx/html/kubam
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(seq -w 1 3) 
<span class="hljs-keyword">do</span> 
    fallocate <span class="hljs-_">-l</span> 1M kube0<span class="hljs-variable">$i</span>.img
    dd <span class="hljs-keyword">if</span>=/dev/zero of=kube0<span class="hljs-variable">${i}</span>.img bs=1M count=1
    mkfs -t ext2 kube0<span class="hljs-variable">$i</span>.img
    e2label kube0<span class="hljs-variable">$i</span>.img KUBAM
    mkdir <span class="hljs-variable">$WORKDIR</span>/kube0<span class="hljs-variable">$i</span>/
    mount -o loop kube0<span class="hljs-variable">$i</span>.img kube0<span class="hljs-variable">$i</span>
<span class="hljs-keyword">done</span>
</code></pre>
<div class="alert alert-warning">
<b>Note:</b> When running this script it will prompt saying the file is not a special device.  Type &apos;y&apos; to Proceed anyway. 
</div>

<p>This will create 3 directories for a KUBaM setup of 3 nodes.  We now need to create the Kickstart files and copy them into the <code>$WORKDIR/kube0$i/</code> directories, then unmount the images. </p>
<h2 id="51-kickstart-images">5.1 Kickstart Images</h2>
<p>The example in <a href="http://localhost:4000/os/2017/04/20/centos-redhat-baremetal" target="_blank">Section 2.2.1.1 of this Post</a> will work for our purposes.   </p>
<ul>
<li>Be sure to put a unique IP address for each node</li>
<li>Substitute your correct encrypted password</li>
<li>Substitute in your public SSH key as shown in the example. </li>
<li>Substitute the mount directory of the tree you created in step 3. This may be something like <code>url --url=&quot;http://example.com/kubam/rh7.3&quot;</code> as we have done in the above example. </li>
</ul>
<p>We have a sample set of UCS Kickstart images that have been known to work in <a href="https://github.com/CiscoUcs/KUBaM/tree/master/stage1/kickstart-samples" target="_blank">the KUBaM github repo</a></p>
<p>To validate your kickstart file install the <code>pykickstart</code> package</p>
<pre><code>yum -y install pykickstart
</code></pre><p>Then validate your kickstart file with: </p>
<pre><code>ksvalidator my-ks.cfg
</code></pre><p>Once you like your <code>ks.cfg</code> copy it into the <code>kube0x</code> directories. </p>
<h3 id="511">5.1.1</h3>
<p>Please note that we recommend putting the public key of the install server in the authorized keys of the nodes you install.  This simplifies the ansible installation as you don&apos;t have to specify passwords. </p>
<p>On the install server run: </p>
<pre><code>ssh-keygen -t rsa
</code></pre><p>Accept all the defaults.  Then you can append the public key in the <code>%post</code> section of the <code>ks.cfg</code> file: </p>
<pre><code>%post
#---- Install our SSH key ----
mkdir -m0700 /root/.ssh/
cat &lt;&lt;EOF &gt;/root/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA5xwR+1+0sBwa0wME6maFjXjIdxUS9taPOgpf1c1EJUgZENDUUOdOabDbEZ6w/xLvx7vHtYDMMTzbyKif9O5hfgQ4RXNjMIMhu+PgShfCsUCFyhMF+cKZNeg2fUZn83r9oWWcFfL31Qh8PMe3yHV30fmBUwpqdCiUCrLznefVwsIlBcnr0DaScU2TdfY73sFR69K6bBJ80GYryaQi2v2s7cjZl2sDMuv5tDNmiOZCxtDJpRS4oaILnRh0gPQaYem0Hl2AGsETsYzqbXsvKkKd96hUtKmoDQ/voHaqFvB6/don12BFQDkTtCGqOCkga7JIGWhAdZbD3+owvOPaPAvK7Q==
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCsmFCXWlhPlews0fXhcW5y1R8+Zudq64eRPN3buKiZ6uTJlpPmJTuo/dnA34Zgb+CXhz4LxEWdS8BYLVcupwIU9GrtLfipIc249WYRPDm8g0PL2S/PEv65ZGTfOzm8ncQBgOYi+1sBoP8ssRDIZzGSUmDfMPhFF2KbAQAq/a1M0hdxwQ4rFJgmPGpIPw8SsOIro10ewp1o+qRGCobdWkMIbexT5XF3Kab9Zg6yWv0XsyNBJ+VwIoD9T7NYYbXU6dXrl82YLKaPkQFGKd7TG6Pdk/5yO71+MPpU8kpQtRSLhGUMLrF3BszYVbK0l+cXLTbrsldtOi+g348WSXFo8SCV root@k8smansvr.k8sdemo
EOF
### set permissions
chmod 0600 /root/.ssh/authorized_keys
### fix up selinux context if you are using it.
#restorecon -R /root/.ssh/
%end
</code></pre><h2 id="52-unmount-kickstart-images">5.2 Unmount Kickstart images</h2>
<p>Once images are ready, you can unmount them. </p>
<pre><code>for i in $(seq -w 3)
do
    umount $WORKDIR/kube0$i/
done
</code></pre><p>Your files are now ready to go. </p>
<h3 id="521-changing-the-kscfg">5.2.1 Changing the ks.cfg</h3>
<p>If you change the <code>ks.cfg</code> image by mounting the filesystem again and then modifying the text, UCS will still mount the old version.  We have found the simplist way to make sure that it remounts the image is to update the vMedia policy by changing just the IP address of the </p>
<h1 id="6-take-stock">6 Take Stock</h1>
<p>Check that we now have all the right files:</p>
<ul>
<li><a href="http://example.com/kubam/rh7.3" target="_blank">http://example.com/kubam/rh7.3</a> - Installation Media Tree</li>
<li><a href="http://example.com/kubam/rh7.3-boot.iso" target="_blank">http://example.com/kubam/rh7.3-boot.iso</a> - Boot ISO image</li>
<li><a href="http://example.com/kubam/kube0{1-3}.img" target="_blank">http://example.com/kubam/kube0{1-3}.img</a> - Kickstart Image files</li>
</ul>
<p>Make sure you can access all of those with your webserver. We will use these for the next step.  </p>
<p><a href="../..">Go to the Next Stage</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="esxi.html" class="navigation navigation-prev " aria-label="Previous page: Stage1 - ESXi">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../stage2/python.html" class="navigation navigation-next " aria-label="Next page: Stage2">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Stage1 - Manual","level":"3.4.3","depth":2,"next":{"title":"Stage2","level":"3.4.4","depth":2,"path":"kubam/internals/stage2/python.md","ref":"kubam/internals/stage2/python.md","articles":[]},"previous":{"title":"Stage1 - ESXi","level":"3.4.2","depth":2,"path":"kubam/internals/stage1/esxi.md","ref":"kubam/internals/stage1/esxi.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"kubam/internals/stage1/manual.md","mtime":"2018-03-01T20:00:39.196Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-05-16T09:24:56.618Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

