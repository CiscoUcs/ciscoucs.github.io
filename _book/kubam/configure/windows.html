
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Windows vMedia Method (WIP) Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="windows2.html" />
    
    
    <link rel="prev" href="template.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">UCS Developer Resources</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../API.html">
            
                <a href="../../API.html">
            
                    
                    UCS API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../PROGRAMMING.html">
            
                <a href="../../PROGRAMMING.html">
            
                    
                    Programming Languages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../CFGMGMT.html">
            
                <a href="../../CFGMGMT.html">
            
                    
                    Configuration Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../OS/">
            
                <a href="../../OS/">
            
                    
                    Operating Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../../OS/COREOS.html">
            
                <a href="../../OS/COREOS.html">
            
                    
                    CoreOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../../OS/REDHAT.html">
            
                <a href="../../OS/REDHAT.html">
            
                    
                    RedHat
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../../CONTAINERS/">
            
                <a href="../../CONTAINERS/">
            
                    
                    Containers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../../SUPPORT.html">
            
                <a href="../../SUPPORT.html">
            
                    
                    Support
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">KUBAM</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../">
            
                <a href="../">
            
                    
                    KUBAM Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../RELEASE.html">
            
                <a href="../RELEASE.html">
            
                    
                    Release Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../installation/">
            
                <a href="../installation/">
            
                    
                    Installation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../installation/standard.html">
            
                <a href="../installation/standard.html">
            
                    
                    Standard CentOS/RedHat Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../installation/ubuntu.html">
            
                <a href="../installation/ubuntu.html">
            
                    
                    Standard Ubuntu Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../installation/network.html">
            
                <a href="../installation/network.html">
            
                    
                    Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.4" data-path="../installation/other.html">
            
                <a href="../installation/other.html">
            
                    
                    Other Tricky Installation Tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="./">
            
                <a href="./">
            
                    
                    Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="creds.md">
            
                <span>
            
                    
                    Credentials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="network.md">
            
                <span>
            
                    
                    Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.3" data-path="servers.md">
            
                <span>
            
                    
                    Servers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.4" data-path="iso.md">
            
                <span>
            
                    
                    Boot Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.5" data-path="settings.html">
            
                <a href="settings.html">
            
                    
                    Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.6" data-path="template.html">
            
                <a href="template.html">
            
                    
                    Kickstart Templates
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.4.7" data-path="windows.html">
            
                <a href="windows.html">
            
                    
                    Windows vMedia Method (WIP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.8" data-path="windows2.html">
            
                <a href="windows2.html">
            
                    
                    Windows vMedia/Network Method (WIP)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../internals/">
            
                <a href="../internals/">
            
                    
                    KUBAM Glorious Underbelly
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="../internals/stage1/docker.html">
            
                <a href="../internals/stage1/docker.html">
            
                    
                    Stage1 - Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="../internals/stage1/esxi.html">
            
                <a href="../internals/stage1/esxi.html">
            
                    
                    Stage1 - ESXi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3" data-path="../internals/stage1/manual.html">
            
                <a href="../internals/stage1/manual.html">
            
                    
                    Stage1 - Manual
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.4" data-path="../internals/stage2/python.html">
            
                <a href="../internals/stage2/python.html">
            
                    
                    Stage2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.5" data-path="../internals/stage3/ansible.html">
            
                <a href="../internals/stage3/ansible.html">
            
                    
                    Stage3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.6" data-path="../internals/stage4/manual.html">
            
                <a href="../internals/stage4/manual.html">
            
                    
                    Stage4
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../developer/">
            
                <a href="../developer/">
            
                    
                    KUBAM Developer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.6.1" data-path="../developer/API.html">
            
                <a href="../developer/API.html">
            
                    
                    KUBAM API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6.2" data-path="../developer/APIGUIDE.html">
            
                <a href="../developer/APIGUIDE.html">
            
                    
                    KUBAM API Walkthrough
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6.3" data-path="../developer/YAML.html">
            
                <a href="../developer/YAML.html">
            
                    
                    KUBAM YAML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Windows vMedia Method (WIP)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="windows-installation">Windows Installation</h1>
<p>KUBAM can be used to deploy Windows. We support</p>
<ul>
<li>Windows 2012 R2</li>
<li>Windows 2016</li>
</ul>
<p>At this time KUBAM requires a decent amount of manual steps to install Windows.  We are working to make this easier but we still hope this method sucks less than other installers that you are using.  </p>
<h1 id="windows-server-2016">Windows Server 2016</h1>
<p>To install Windows Server 2016, we will use unattended instalation feature. That will give us zero-touch deployment. We will use original Windows Server 2016 instalation iso in combination with &quot;answer file&quot;. To prepare and create answer file (<strong>autounattend.xml</strong>) we are using <strong>Windows System Image Manager (SIM)</strong> tool from <strong>Windows Assessment and Deployment Kit (ADK)</strong>. Preparation of the answer file should be done on Windows workstation or server. Answer file will be packed into .img file and mounted as additional drive in UCS vMedia Policy.</p>
<h2 id="download-and-install-latest-windows-adk">Download and install latest Windows ADK</h2>
<p>Windows ADK can be downloaded from <a href="https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install" target="_blank">Microsoft website</a>.</p>
<p><img src="../img/ADK download.png" alt="img"></p>
<p>After ADK is downloaded we will start installation on the local machine. We just need to install Deployment Tools feature which consist Windows System Image Manager.</p>
<p><img src="../img/ADK setup.png" alt="img"></p>
<h2 id="creating-answer-file-autounattendxml">Creating &quot;answer file&quot; (autounattend.xml)</h2>
<p>To be able to generate answer file, we need to copy content of Windows Server 2016 instalation image (.iso) to some folder on our workstation (or server). We can mount it to virtual optical drive, or extract it using archiver. In this example we are using <a href="https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016" target="_blank">Windows Server 2016 Evaluation</a> (14393.0.161119-1705.RS1_REFRESH_SERVER_EVAL_X64FRE_EN-US.ISO), and unpacking ith with archiver.</p>
<p><img src="../img/ISO extraction.png" alt="img"></p>
<p>We will not use extracted files after answer file creation, just original .iso image.</p>
<p>After we have instalation files on our workstation, we will run Windows System Image Manager that we have installed in previous step.</p>
<p><img src="../img/Run SIM.png" alt="img"></p>
<p>In System Image Manager we have to import instalation image to create <strong>answer file</strong>.  </p>
<p><img src="../img/Select Windows Image.png" alt="img"></p>
<p>We are selecting <strong>install.wim</strong> from the <strong>/sources</strong> folder in extracted .iso image.
<img src="../img/Install wim.png" alt="img"></p>
<p>We have option to choose which version of operative system we want to prepare answer file for. We are selecting <strong>Windows Server 2016 SERVERDATACENTER</strong>.
<img src="../img/Select OS.png" alt="img"></p>
<p>We have to wait for few minutes while SIM is generating catalog file. After catalog file is created we will create new answer file (File &gt; New Answer File). Now we can start adding components for our answer file.</p>
<p>First we are selecting <strong>amd64_Microsoft-Windows-International-Core-WinPE_neutral</strong> from lower left pane, and place it in answer file pane under <strong>1. windowsPE</strong>.</p>
<p>Then we have to specify language settings, you will enter values for your language preferences, we are entering <strong>en-US</strong>:</p>
<ul>
<li><strong>InputLocale:</strong> Keyboard layout (<strong>en-US</strong>)</li>
<li><strong>SystemLocale:</strong> system locale language (<strong>en-US</strong>)</li>
<li><strong>UILanguage:</strong> User Interface language (<strong>en-US</strong>)</li>
<li><strong>UserLocale:</strong> per-user settings for currency, time, numbers... (<strong>en-US</strong>)</li>
</ul>
<p><img src="../img/1windowsPE1.png" alt="img"></p>
<p>Click <strong>+</strong> next to <strong>amd64_Microsoft-Windows-International-Core-WinPE_neutral</strong> in middle pane and navigate to <strong>SetupUILanguage</strong> to specify the language used during Windows Setup.</p>
<p><img src="../img/Setup Language.png" alt="img"></p>
<p>Next, we are selecting amd64<em>Microsoft-Windows-Setup, placing it in <strong>1. WindowsPE</strong>, navigating to <strong>DiskConfiguration</strong> and right clicking on it to <em>_Insert New Disk</em></em>.</p>
<p><img src="../img/Insert Disk.png" alt="img"></p>
<p>We have to create partitions on Hard Drive. We are using <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/hh825701(v%3dwin.10" target="_blank">this</a>) Microsoft guide for configuring <strong>BIOS/MBR-Based Hard Drive Partitions</strong>:</p>
<p><img src="../img/MBR Partition.png" alt="img"></p>
<p>Click <strong>+</strong> next to <strong>Disk</strong> in middle pane and right click on <strong>CreatePartition</strong>. Select <strong>Insert New CreatePartition</strong>. Populate settings based on above example. Repeate procedure for adding second partition.</p>
<p>Right click on <strong>ModifyPartitions</strong>. Select <strong>Insert New ModifyPartition</strong>. Again populate settings based on above example. Repeate procedure for modifying second partition.</p>
<p>Click <strong>+</strong> next to <strong>ImageInstall</strong>, navigate to <strong>InstallTo</strong> and populate it according to example.</p>
<p>After following this steps, your disk configuration should look like this:</p>
<p><img src="../img/Disk Config.png" alt="img"></p>
<p>If you want to configure <strong>UEFI/GPT-Based Hard Drive Partitions</strong>, you can follow <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/hh825702(v=win.10" target="_blank">this guide</a>)</p>
<p>Now we are setting up <strong>InstallFrom</strong> under <strong>ImageInstall</strong>. As there can be multiple Windows images inside <strong>install.wim</strong>, we have to look into it to select image we want to install.</p>
<p>To get a list of included OS instalations, we are going to run <strong>dism</strong> tool (included in Windows OS) in command prompt and point to <strong>install.wim</strong>.</p>
<pre><code>dism /Get-ImageInfo /ImageFile:&lt;Path to file&gt;\install.wim
</code></pre><p>We are getting following output from <strong>dism</strong> tool:</p>
<p><img src="../img/dism.png" alt="img"></p>
<p>In this example we want to install <strong>Windows Server 2016 Datacenter Evaluation (Desktop Experience)</strong>, which <strong>index</strong> is <strong>4</strong>.</p>
<p>Right click on <strong>InstallFrom</strong> and select <strong>Insert New MetaData</strong>, under settings enter key <strong>/IMAGE/INDEX</strong> and value <strong>4</strong></p>
<p><img src="../img/Image Index.png" alt="img"></p>
<p>Next, we have to set up user data. Click on <strong>UserData</strong> section and, set <strong>AcceptEula</strong> to <strong>true</strong> and fill in your settings.</p>
<p><img src="../img/User Data.png" alt="img"></p>
<p>If you want to add <strong>licence key</strong>, you can add it in <strong>ProductKey</strong> section. We are going to skip this part as we are working with evaluation image.</p>
<p>Next we are adding <strong>amd64_Microsoft-Windows-Shell-Setup</strong> both to <strong>4. specialize</strong> and <strong>7. oobeSystem</strong> section. Under <strong>4. specialize</strong> section fill in <strong>ComputerName</strong> and <strong>TimeZone</strong>. For finding out right name your time zone you can use <strong>tzutil /l</strong> comand in command prompt on your windows machine.</p>
<p><img src="../img/Shell Setup.png" alt="img"></p>
<p>From oobeSystem section navigate to <strong>UserAccounts</strong> &gt; <strong>AdministratorPassword</strong>, and enter Administrator password (Example here is &quot;Pa$$w0rd&quot;).</p>
<p><img src="../img/Admin Pass.png" alt="img"></p>
<p>We will add <strong>amd64_Microsoft-Windows-TerminalServices-LocalSessionManager</strong> to <strong>4 specialize</strong> and set <strong>fDenyTSConnections</strong> to false to enable the RDP connection.</p>
<p><img src="../img/RDP.png" alt="img"></p>
<p>Now we are going to configure folder where we will provide drivers for operative system during installation. From the left pane drag <strong>amd64_Microsoft-Windows-PnpCustomizationsWinPE</strong> to <strong>1 windowsPE</strong>, right click on <strong>DriverPaths</strong> and <strong>Insert New PathAndCredentials</strong></p>
<p><img src="../img/Driver Path 1.png" alt="img"></p>
<p>Next we are setting <strong>PathAndCredentials</strong>. <strong>Key</strong> value <strong>1</strong> and <strong>Path: %configsetroot%\drivers</strong>. With <strong>%configsetroot%</strong> variable we are pointing to drive containing answer file.</p>
<p><img src="../img/Driver Path 2.png" alt="img"></p>
<p>We need to set <em>UseConfigurationSet</em> under <strong>amd64_Microsoft-Windows-Setup</strong> to <strong>true</strong> so setup is going to use Driver Paths folder that we have set up and copy it under <strong>C:\Windows\ConfigSetRoot</strong> folder.</p>
<p><img src="../img/Use Configuration Set.png" alt="img"></p>
<p>Under <strong>7 oobeSystem</strong> inside <strong>amd64_Microsoft-Windows-Shell-Setup</strong> right click to <strong>FirstLogonCommands</strong> and <strong>Insert New SychronousCommand</strong>. Insert <strong>C:\Windows\ConfigSetRoot\drivers\configure\configureos.cmd</strong> to <strong>CommandLine</strong>, add <strong>Description</strong> and set <strong>Order</strong> as <strong>1</strong>. 
File <strong>configureos.cmd</strong> will contain instruction to run powershell script that we will do rest of the setup.</p>
<p><img src="../img/configureos.png" alt="img"></p>
<p>We are configuring <strong>AutoLogon</strong> under same section that will run 3 times to run a PowerShell script with additional setup that will need reboots. We also need to provide password under <strong>Password</strong> section (same that we have setup in earlier steps, in this example: Pa$$w0rd).</p>
<p><img src="../img/autologon.png" alt="img"></p>
<p>Now we have ready answer file, and we are going to save it as <strong>autounattend.xml</strong> in our working folder (stage). 
<img src="../img/autounattend.png" alt="img"></p>
<p>Our answer file now looks like this:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;unattend xmlns=&quot;urn:schemas-microsoft-com:unattend&quot;&gt;
    &lt;settings pass=&quot;windowsPE&quot;&gt;
        &lt;component name=&quot;Microsoft-Windows-International-Core-WinPE&quot; processorArchitecture=&quot;amd64&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
            &lt;SetupUILanguage&gt;
                &lt;UILanguage&gt;en-US&lt;/UILanguage&gt;
            &lt;/SetupUILanguage&gt;
            &lt;InputLocale&gt;en-US&lt;/InputLocale&gt;
            &lt;SystemLocale&gt;en-US&lt;/SystemLocale&gt;
            &lt;UILanguage&gt;en-US&lt;/UILanguage&gt;
            &lt;UserLocale&gt;en-US&lt;/UserLocale&gt;
        &lt;/component&gt;
        &lt;component name=&quot;Microsoft-Windows-Setup&quot; processorArchitecture=&quot;amd64&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
            &lt;DiskConfiguration&gt;
                &lt;Disk wcm:action=&quot;add&quot;&gt;
                    &lt;CreatePartitions&gt;
                        &lt;CreatePartition wcm:action=&quot;add&quot;&gt;
                            &lt;Order&gt;1&lt;/Order&gt;
                            &lt;Size&gt;350&lt;/Size&gt;
                            &lt;Type&gt;Primary&lt;/Type&gt;
                        &lt;/CreatePartition&gt;
                        &lt;CreatePartition wcm:action=&quot;add&quot;&gt;
                            &lt;Order&gt;2&lt;/Order&gt;
                            &lt;Extend&gt;true&lt;/Extend&gt;
                            &lt;Type&gt;Primary&lt;/Type&gt;
                        &lt;/CreatePartition&gt;
                    &lt;/CreatePartitions&gt;
                    &lt;ModifyPartitions&gt;
                        &lt;ModifyPartition wcm:action=&quot;add&quot;&gt;
                            &lt;Active&gt;true&lt;/Active&gt;
                            &lt;Format&gt;NTFS&lt;/Format&gt;
                            &lt;Label&gt;System&lt;/Label&gt;
                            &lt;Order&gt;1&lt;/Order&gt;
                            &lt;PartitionID&gt;1&lt;/PartitionID&gt;
                        &lt;/ModifyPartition&gt;
                        &lt;ModifyPartition wcm:action=&quot;add&quot;&gt;
                            &lt;Format&gt;NTFS&lt;/Format&gt;
                            &lt;Label&gt;Windows&lt;/Label&gt;
                            &lt;Letter&gt;C&lt;/Letter&gt;
                            &lt;Order&gt;2&lt;/Order&gt;
                            &lt;PartitionID&gt;2&lt;/PartitionID&gt;
                        &lt;/ModifyPartition&gt;
                    &lt;/ModifyPartitions&gt;
                    &lt;DiskID&gt;0&lt;/DiskID&gt;
                    &lt;WillWipeDisk&gt;true&lt;/WillWipeDisk&gt;
                &lt;/Disk&gt;
            &lt;/DiskConfiguration&gt;
            &lt;ImageInstall&gt;
                &lt;OSImage&gt;
                    &lt;InstallFrom&gt;
                        &lt;MetaData wcm:action=&quot;add&quot;&gt;
                            &lt;Key&gt;/IMAGE/INDEX&lt;/Key&gt;
                            &lt;Value&gt;4&lt;/Value&gt;
                        &lt;/MetaData&gt;
                    &lt;/InstallFrom&gt;
                    &lt;InstallTo&gt;
                        &lt;DiskID&gt;0&lt;/DiskID&gt;
                        &lt;PartitionID&gt;2&lt;/PartitionID&gt;
                    &lt;/InstallTo&gt;
                &lt;/OSImage&gt;
            &lt;/ImageInstall&gt;
            &lt;UserData&gt;
                &lt;AcceptEula&gt;true&lt;/AcceptEula&gt;
                &lt;FullName&gt;Kubam&lt;/FullName&gt;
                &lt;Organization&gt;Kubam&lt;/Organization&gt;
            &lt;/UserData&gt;
            &lt;UseConfigurationSet&gt;true&lt;/UseConfigurationSet&gt;
        &lt;/component&gt;
        &lt;component name=&quot;Microsoft-Windows-PnpCustomizationsWinPE&quot; processorArchitecture=&quot;amd64&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
            &lt;DriverPaths&gt;
                &lt;PathAndCredentials wcm:action=&quot;add&quot; wcm:keyValue=&quot;1&quot;&gt;
                    &lt;Path&gt;%configsetroot%\drivers&lt;/Path&gt;
                &lt;/PathAndCredentials&gt;
            &lt;/DriverPaths&gt;
        &lt;/component&gt;
    &lt;/settings&gt;
    &lt;settings pass=&quot;specialize&quot;&gt;
        &lt;component name=&quot;Microsoft-Windows-Shell-Setup&quot; processorArchitecture=&quot;amd64&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
            &lt;ComputerName&gt;Kubam&lt;/ComputerName&gt;
            &lt;TimeZone&gt;Pacific Standard Time_dstoff&lt;/TimeZone&gt;
        &lt;/component&gt;
        &lt;component name=&quot;Microsoft-Windows-TerminalServices-LocalSessionManager&quot; processorArchitecture=&quot;amd64&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
            &lt;fDenyTSConnections&gt;false&lt;/fDenyTSConnections&gt;
        &lt;/component&gt;
    &lt;/settings&gt;
    &lt;settings pass=&quot;oobeSystem&quot;&gt;
        &lt;component name=&quot;Microsoft-Windows-Shell-Setup&quot; processorArchitecture=&quot;amd64&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
            &lt;AutoLogon&gt;
                &lt;Password&gt;
                    &lt;Value&gt;UABhACQAJAB3ADAAcgBkAFAAYQBzAHMAdwBvAHIAZAA=&lt;/Value&gt;
                    &lt;PlainText&gt;false&lt;/PlainText&gt;
                &lt;/Password&gt;
                &lt;Enabled&gt;true&lt;/Enabled&gt;
                &lt;LogonCount&gt;3&lt;/LogonCount&gt;
                &lt;Username&gt;administrator&lt;/Username&gt;
            &lt;/AutoLogon&gt;
            &lt;FirstLogonCommands&gt;
                &lt;SynchronousCommand wcm:action=&quot;add&quot;&gt;
                    &lt;CommandLine&gt;c:\Windows\ConfigSetRoot\drivers\configure\configureos.cmd&lt;/CommandLine&gt;
                    &lt;Description&gt;Configure OS&lt;/Description&gt;
                    &lt;Order&gt;1&lt;/Order&gt;
                &lt;/SynchronousCommand&gt;
            &lt;/FirstLogonCommands&gt;
            &lt;UserAccounts&gt;
                &lt;AdministratorPassword&gt;
                    &lt;Value&gt;UABhACQAJAB3ADAAcgBkAEEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAUABhAHMAcwB3AG8AcgBkAA==&lt;/Value&gt;
                    &lt;PlainText&gt;false&lt;/PlainText&gt;
                &lt;/AdministratorPassword&gt;
            &lt;/UserAccounts&gt;
        &lt;/component&gt;
    &lt;/settings&gt;
    &lt;cpi:offlineImage cpi:source=&quot;wim://vmware-host/shared%20folders/desktop/winserver2016_deploy/14393.0.161119-1705.rs1_refresh_server_eval_x64fre_en-us/sources/install.wim#Windows Server 2016 SERVERDATACENTER&quot; xmlns:cpi=&quot;urn:schemas-microsoft-com:cpi&quot; /&gt;
&lt;/unattend&gt;
</code></pre><p>You can use this file as a template, without need to do compleate procedure, just change values according to your preferred settings.</p>
<h2 id="downloading-drivers">Downloading drivers</h2>
<p>Next step is to <a href="https://software.cisco.com/download/home/283853163/type/283853158/release/3.2%25283a%2529" target="_blank">download UCS drivers for Windows</a> from Cisco, in this example we are installing UCS B-series servers, so we are downloading drivers for UCS B.</p>
<p><img src="../img/UCS Drivers.png" alt="img"></p>
<h2 id="packing-answer-file-and-drivers">Packing answer file and drivers</h2>
<p>Create new folder named <strong>drivers</strong> in working folder. Copy and extract downloaded .iso file (we were using 7-zip here) into working folder.</p>
<p><img src="../img/extract drivers.png" alt="img"></p>
<p>Delete <strong>Video, release.txt, tag.txt and driver .iso</strong> file from <strong>drivers</strong> folder.</p>
<p><img src="../img/delete video.png" alt="img"></p>
<p>Go back to working folder, select <strong>drivers</strong> filder and <strong>autoattend.xml</strong> file and pack them to <strong>stage.zip</strong></p>
<p><img src="../img/add to zip.png" alt="img"> </p>
<p><a href="https://winscp.net/eng/download.php" target="_blank">Download</a> and install WinScp, and create new session to connect to Kubam server using SCP protocol. Open <strong>/root/kubam</strong> folder in right pane and our working folder (stage) in left pane.</p>
<p><img src="../img/winscp.png" alt="img"></p>
<p>Upload <strong>stage.zip</strong> to kubam server into <strong>/root/kubam</strong> folder (drag and drop).</p>
<p><img src="../img/upload stage.png" alt="img"></p>
<p>Log into kubam server and navigate to /root/kubam folder. There should be <strong>stage.zip</strong> file. Using bellow commands we will create <strong>win2016.img</strong> file containing drivers and answer file. </p>
<pre><code>unzip -qq stage.zip
rm -f stage.zip
dd if=/dev/zero ibs=1024 count=300000 of=win2016.img
mkfs -t fat win2016.img  
mkdir mnt
mount -o loop win2016.img mnt
mv -t mnt autounattend.xml drivers
umount mnt
rm -Rf mnt
</code></pre><p>After running commands, you should have similar output on kubam server.</p>
<p><img src="../img/unpack_pack.png" alt="img"></p>
<p>We will copy <strong>win2016.img</strong> back to our workstation.</p>
<p><img src="../img/win2016img.png" alt="img"></p>
<p>Next step is to copy created <strong>win2016.img</strong> and windows 2016 installation image (14393.0.161119-1705.RS1_REFRESH_SERVER_EVAL_X64FRE_EN-US.ISO) to network share wich will be available for UCS Manager. First we will rename .iso image to <strong>win_server_2016.iso</strong> for convenience. </p>
<p><img src="../img/copytonas.png" alt="img"></p>
<h2 id="add-installation-files-to-vmedia-policy">Add installation files to vMedia Policy</h2>
<p>In UCS manager create Vmedia Policy and set it according to pictures bellow, pointing <strong>win_server_2016.iso</strong> and <strong>win2016.img</strong> to shared location.</p>
<p><img src="../img/vMedia1.png" alt="img"></p>
<p><img src="../img/vMedia2.png" alt="img"></p>
<p><img src="../img/vMedia3.png" alt="img"></p>
<p>Start server, open KVM, take popcorns and enjoj:). 
Now you have Zero-Touch Windows 2016 installation for your servers!</p>
<p><img src="../img/kvm.png" alt="img"></p>
<p>And after few minutes you can log on with username (administrator) and password (Pa$$w0rd) set in <strong>autounattend.xml</strong> file. </p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="template.html" class="navigation navigation-prev " aria-label="Previous page: Kickstart Templates">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="windows2.html" class="navigation navigation-next " aria-label="Next page: Windows vMedia/Network Method (WIP)">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Windows vMedia Method (WIP)","level":"3.4.7","depth":2,"next":{"title":"Windows vMedia/Network Method (WIP)","level":"3.4.8","depth":2,"path":"kubam/configure/windows2.md","ref":"kubam/configure/windows2.md","articles":[]},"previous":{"title":"Kickstart Templates","level":"3.4.6","depth":2,"path":"kubam/configure/template.md","ref":"kubam/configure/template.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"kubam/configure/windows.md","mtime":"2018-05-10T13:26:10.508Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-29T21:50:59.533Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

